# ═════════════════════════════════════════════════════════════════════════════
# EMERALD ERP - Archivo de Configuración de Entorno (.env.example)
# ═════════════════════════════════════════════════════════════════════════════
#
# Este archivo contiene TODAS las variables de entorno disponibles.
# Copia este archivo a .env y completa con tus valores:
#
#   cp .env.example .env
#   nano .env
#
# NOTA: NUNCA commitear .env a Git. Solo .env.example.
# ═════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────
# 1. BASE DE DATOS (PostgreSQL)
# ─────────────────────────────────────────────────────────────────────────────

# Usuario de la base de datos
# Default: admin
# Producción: cambiar a algo más seguro
POSTGRES_USER=admin

# Contraseña de la base de datos
# ⚠️ CRÍTICO: Usar contraseña fuerte (>16 caracteres, números, símbolos)
# Ejemplo seguro: $(openssl rand -base64 32)
POSTGRES_PASSWORD=adminpassword

# Nombre de la base de datos
# Default: emerald
POSTGRES_DB=emerald

# ─────────────────────────────────────────────────────────────────────────────
# 2. BACKEND (FastAPI)
# ─────────────────────────────────────────────────────────────────────────────

# API Key para endpoints protegidos
# Generada: openssl rand -base64 32
# Ejemplo: wB3kL9mP2xY5qR7tZ1jN4vA8dF6sH0bJ
API_KEY=tu_api_key_super_secreta_aqui_cambiame

# Entorno: development | staging | production
# Afecta logging, cors, y comportamiento de la app
ENVIRONMENT=development

# Puerto donde escucha FastAPI (interno dentro del container)
# Default: 5000
# Nginx hace proxy a este puerto
FASTAPI_PORT=5000

# Modo debug (solo en desarrollo)
# development: True
# production: False
DEBUG=False

# ─────────────────────────────────────────────────────────────────────────────
# 3. MIKROTIK (RouterOS)
# ─────────────────────────────────────────────────────────────────────────────

# IP del router Mikrotik principal
# Ejemplo: 192.168.1.1 (router local)
# o: 10.0.0.1 (router remoto)
MK_HOST=192.168.1.100

# Puerto de API de Mikrotik
# Default: 8728 (sin SSL) o 8729 (con SSL)
# Ver MK_ENABLE_SSL
MK_PORT=8728

# Usuario Mikrotik con acceso a /ppp/secret
# Recomendación: crear usuario específico con permisos limitados
# [admin@MikroTik] > /user/add name=emerald-sync password=strong
MK_USER=admin

# Contraseña del usuario Mikrotik
MK_PASS=contraseña_router

# ¿Usar SSL para conexión Mikrotik?
# false: Conexión plaintext a puerto 8728 (desarrollo)
# true: Conexión SSL a puerto 8729 (producción recomendado)
MK_ENABLE_SSL=false

# Timeout para conexión Mikrotik (segundos)
# Default: 10
# Si la red es lenta, aumentar
MK_TIMEOUT=10

# ─────────────────────────────────────────────────────────────────────────────
# 4. ISPCube (Sistema de Gestión ISP)
# ─────────────────────────────────────────────────────────────────────────────

# URL de la API de ISPCube
# Ejemplo: http://192.168.1.50:8080
# o: https://ispcube.example.com
ISPCUBE_API_URL=http://192.168.1.50:8080

# API Key o Token para autenticación en ISPCube
# Preguntar a administrador de ISPCube
ISPCUBE_API_KEY=tu_api_key_ispcube_aqui

# ¿Sincronizar datos de ISPCube?
# true: Sincronizar clientes, planes, conexiones
# false: Desactivar esta fuente
ISPCUBE_SYNC_ENABLED=true

# ─────────────────────────────────────────────────────────────────────────────
# 5. SMARTOLT (OLT para FTTH)
# ─────────────────────────────────────────────────────────────────────────────

# URL de la API de SmartOLT
# Ejemplo: http://192.168.2.100:8080
SMARTOLT_API_URL=http://192.168.2.100:8080

# API Key para SmartOLT
SMARTOLT_API_KEY=tu_api_key_smartolt_aqui

# ID del OLT registrado en SmartOLT
# Ejemplo: OLT_001
SMARTOLT_OLT_ID=OLT_001

# ¿Sincronizar datos de SmartOLT?
# true: Obtener estado de ONUs, señales ópticas
# false: Desactivar
SMARTOLT_SYNC_ENABLED=true

# ─────────────────────────────────────────────────────────────────────────────
# 6. FRONTEND (React/Vite - Puerto 3000)
# ─────────────────────────────────────────────────────────────────────────────

# URL base de la API vista desde el navegador
# /api: Usa nginx como proxy (producción)
# http://localhost:5000: Conecta directo al backend (desarrollo)
VITE_API_URL=/api

# Habilitar Hot Module Reload en Docker
# true: Para desarrollo con live reloading
# false: Para producción
CHOKIDAR_USEPOLLING=true

# ─────────────────────────────────────────────────────────────────────────────
# 7. BEHOLDER (Monitor/Dashboard - Puerto 3001)
# ─────────────────────────────────────────────────────────────────────────────

# URL de API para Beholder
# Normalmente igual que VITE_API_URL
BEHOLDER_API_URL=/api

# API Key si Beholder requiere autenticación especial
# Puede estar vacío si usa la misma auth que el resto
BEHOLDER_API_KEY=

# ─────────────────────────────────────────────────────────────────────────────
# 8. REDIS (Message Broker para Celery)
# ─────────────────────────────────────────────────────────────────────────────

# Host de Redis (dentro de Docker compose, es "redis")
# Default: redis
REDIS_HOST=redis

# Puerto de Redis
# Default: 6379
REDIS_PORT=6379

# Base de datos de Redis para Celery
# Default: 0
REDIS_DB=0

# Contraseña de Redis (si está protegido)
# Dejar vacío si no tiene password
REDIS_PASSWORD=

# ─────────────────────────────────────────────────────────────────────────────
# 9. CELERY (Tareas Asincrónicas)
# ─────────────────────────────────────────────────────────────────────────────

# Broker de Celery (dónde guarda las tareas)
# Formato: redis://[password@]host:port/db
CELERY_BROKER_URL=redis://redis:6379/0

# Backend de resultados de Celery (dónde guarda resultados)
CELERY_RESULT_BACKEND=redis://redis:6379/0

# Concurrencia de workers Celery
# Default: 4 (cuántos procesos paralelos)
# Para VPS pequeño: 1-2
# Para servidor dedicado: 4-8
CELERY_CONCURRENCY=4

# Timezone para tareas programadas
# UTC o tu zona horaria: America/Argentina/Buenos_Aires
CELERY_TIMEZONE=America/Argentina/Buenos_Aires

# ─────────────────────────────────────────────────────────────────────────────
# 10. SINCRONIZACIÓN (Background Jobs)
# ─────────────────────────────────────────────────────────────────────────────

# ¿Ejecutar sincronización automática?
# true: Se sincroniza diariamente a las 3 AM (zona CELERY_TIMEZONE)
# false: Manual solo
SYNC_ENABLED=true

# Hora de sincronización diaria (formato 24h)
# Ejemplo: 03 = 3 AM
# Zona: definida en CELERY_TIMEZONE
SYNC_HOUR=03
SYNC_MINUTE=00

# Reintentos automáticos si falla sincronización
# Default: 3
SYNC_MAX_RETRIES=3

# ─────────────────────────────────────────────────────────────────────────────
# 11. LOGGING
# ─────────────────────────────────────────────────────────────────────────────

# Nivel de logs
# DEBUG: Todos los logs (verboso, para desarrollo)
# INFO: Información general
# WARNING: Solo advertencias y errores
# ERROR: Solo errores críticos
LOG_LEVEL=INFO

# Archivo de logs
# Ruta dentro del container
LOG_FILE=/app/data/logs/app.log

# Máximo tamaño de archivo log antes de rotar (MB)
# Default: 10 (rota cuando llegue a 10MB)
LOG_MAX_SIZE_MB=10

# Cantidad de archivos de log a mantener
# Default: 5 (guardar últimos 5 archivos rotados)
LOG_BACKUP_COUNT=5

# ─────────────────────────────────────────────────────────────────────────────
# 12. NGINX (Reverse Proxy)
# ─────────────────────────────────────────────────────────────────────────────

# Dominio principal
# Ejemplo: emerald.2finternet.ar
# Usado para certificados SSL
DOMAIN=emerald.2finternet.ar

# Email para notificaciones de Let's Encrypt
# Recibe alertas si certificado está por vencer
LETSENCRYPT_EMAIL=admin@tu_email.com

# ─────────────────────────────────────────────────────────────────────────────
# 13. SEGURIDAD
# ─────────────────────────────────────────────────────────────────────────────

# ¿Forzar HTTPS?
# true: Redirigir todo HTTP → HTTPS
# false: Permitir HTTP (solo para desarrollo)
FORCE_HTTPS=true

# CORS - Orígenes permitidos
# "*": Permitir todos (desarrollo)
# "https://emerald.2finternet.ar": Solo este dominio (producción)
CORS_ORIGINS=*

# Rate limiting en API
# Solicitudes por segundo
RATE_LIMIT_RPS=10

# Bursts permitidos (sobre limite)
RATE_LIMIT_BURST=20

# ─────────────────────────────────────────────────────────────────────────────
# 14. NOTIFICACIONES (Opcional)
# ─────────────────────────────────────────────────────────────────────────────

# Email para alertas de sistema
# Recibe notificaciones de errores críticos
ALERT_EMAIL=admin@tu_email.com

# Servidor SMTP para enviar emails
# Ejemplo: smtp.gmail.com
SMTP_SERVER=smtp.gmail.com

# Puerto SMTP (25, 465, 587)
SMTP_PORT=587

# Usuario SMTP
SMTP_USER=tu_email@gmail.com

# Contraseña SMTP (aplicación, no contraseña real)
SMTP_PASSWORD=tu_contraseña_app

# ─────────────────────────────────────────────────────────────────────────────
# 15. BACKUP
# ─────────────────────────────────────────────────────────────────────────────

# Directorio de backups
BACKUP_DIR=/app/data/backups

# ¿Fazer backup automático?
# true: Diario a las 2 AM
# false: Manual solo
BACKUP_ENABLED=true

# Retención de backups (días)
# Elimina backups más antiguos que esto
BACKUP_RETENTION_DAYS=30

# ═════════════════════════════════════════════════════════════════════════════
# EJEMPLOS DE VALORES COMPLETOS PARA DIFERENTES ENTORNOS
# ═════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────
# DESARROLLO LOCAL
# ─────────────────────────────────────────────────────────────────────────────
#
# POSTGRES_USER=admin
# POSTGRES_PASSWORD=adminpassword
# POSTGRES_DB=emerald
# API_KEY=dev_key_no_segura
# ENVIRONMENT=development
# DEBUG=True
# MK_HOST=192.168.1.100
# VITE_API_URL=/api
# FORCE_HTTPS=false
# CORS_ORIGINS=*
#

# ─────────────────────────────────────────────────────────────────────────────
# PRODUCCIÓN EN VPS
# ─────────────────────────────────────────────────────────────────────────────
#
# POSTGRES_USER=emerald_prod
# POSTGRES_PASSWORD=wB3kL9mP2xY5qR7tZ1jN4vA8dF6sH0bJ  # openssl rand -base64 32
# POSTGRES_DB=emerald
# API_KEY=xYz9Kj7Hm5Qw2Er0Tp3As4Df6Gg8Bh1Jl  # openssl rand -base64 32
# ENVIRONMENT=production
# DEBUG=False
# MK_HOST=10.0.0.1
# MK_ENABLE_SSL=true
# DOMAIN=emerald.2finternet.ar
# LETSENCRYPT_EMAIL=ops@tu_empresa.com
# FORCE_HTTPS=true
# CORS_ORIGINS=https://emerald.2finternet.ar
# SYNC_ENABLED=true
# BACKUP_ENABLED=true
#

# ═════════════════════════════════════════════════════════════════════════════
# VALIDACIÓN
# ═════════════════════════════════════════════════════════════════════════════
#
# El script backend/src/config.py verificará que estas variables existan:
#
# CRÍTICAS (Sin estas, no arranca):
# - POSTGRES_USER, POSTGRES_PASSWORD, POSTGRES_DB
# - API_KEY
# - MK_HOST, MK_USER, MK_PASS
#
# RECOMENDADAS (Warning si faltan):
# - ISPCUBE_API_URL, ISPCUBE_API_KEY
# - SMARTOLT_API_URL, SMARTOLT_API_KEY
# - DOMAIN, LETSENCRYPT_EMAIL
#

# ═════════════════════════════════════════════════════════════════════════════
# HISTORIAL DE CAMBIOS
# ═════════════════════════════════════════════════════════════════════════════
# 2025-12-30: Creación inicial con documentación completa
# 2025-12-15: Agregadas variables de Celery y Backup
# ═════════════════════════════════════════════════════════════════════════════
